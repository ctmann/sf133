library(tidyverse)


# PL Title ----------------------------------------------------------------


ref.pl <- tribble(
  ~PL.title.code,         ~PL.title, ~account.code,
              10,   "MIL PERSONNEL",          1105,
              10,   "MIL PERSONNEL",          1108,
              10,   "MIL PERSONNEL",          1405,
              10,   "MIL PERSONNEL",          1453,
              10,   "MIL PERSONNEL",          2010,
              10,   "MIL PERSONNEL",          2060,
              10,   "MIL PERSONNEL",          2070,
              10,   "MIL PERSONNEL",          3500,
              10,   "MIL PERSONNEL",          3700,
              10,   "MIL PERSONNEL",          3850,
              20,     "OPR & MAINT",           100,
              20,     "OPR & MAINT",           104,
              20,     "OPR & MAINT",           105,
              20,     "OPR & MAINT",           107,
              20,     "OPR & MAINT",           111,
              20,     "OPR & MAINT",           130,
              20,     "OPR & MAINT",           134,
              20,     "OPR & MAINT",           145,
              20,     "OPR & MAINT",           819,
              20,     "OPR & MAINT",          1106,
              20,     "OPR & MAINT",          1107,
              20,     "OPR & MAINT",          1804,
              20,     "OPR & MAINT",          1806,
              20,     "OPR & MAINT",          2020,
              20,     "OPR & MAINT",          2065,
              20,     "OPR & MAINT",          2080,
              20,     "OPR & MAINT",          2091,
              20,     "OPR & MAINT",          2096,
              20,     "OPR & MAINT",          2097,
              20,     "OPR & MAINT",          3400,
              20,     "OPR & MAINT",          3740,
              20,     "OPR & MAINT",          3840,
              30,     "PROCUREMENT",           300,
              30,     "PROCUREMENT",           350,
              30,     "PROCUREMENT",           390,
              30,     "PROCUREMENT",          1109,
              30,     "PROCUREMENT",          1506,
              30,     "PROCUREMENT",          1507,
              30,     "PROCUREMENT",          1508,
              30,     "PROCUREMENT",          1611,
              30,     "PROCUREMENT",          1810,
              30,     "PROCUREMENT",          2031,
              30,     "PROCUREMENT",          2032,
              30,     "PROCUREMENT",          2033,
              30,     "PROCUREMENT",          2034,
              30,     "PROCUREMENT",          2035,
              30,     "PROCUREMENT",          2093,
              30,     "PROCUREMENT",          3010,
              30,     "PROCUREMENT",          3011,
              30,     "PROCUREMENT",          3020,
              30,     "PROCUREMENT",          3080,
              40,           "RDT&E",           400,
              40,           "RDT&E",           460,
              40,           "RDT&E",          1319,
              40,           "RDT&E",          2040,
              40,           "RDT&E",          3600,
              50,         "MIL CON",           391,
              50,         "MIL CON",           500,
              50,         "MIL CON",          1205,
              50,         "MIL CON",          1235,
              50,         "MIL CON",          2050,
              50,         "MIL CON",          2085,
              50,         "MIL CON",          2086,
              50,         "MIL CON",          3300,
              50,         "MIL CON",          3730,
              50,         "MIL CON",          3830,
              60,       "FMLY HSNG",           720,
              60,       "FMLY HSNG",           725,
              60,       "FMLY HSNG",           730,
              60,       "FMLY HSNG",           735,
              60,       "FMLY HSNG",           740,
              60,       "FMLY HSNG",           745,
              60,       "FMLY HSNG",           760,
              60,       "FMLY HSNG",           765,
              95, "CIVIL FUNCTIONS",          1805,
              95, "CIVIL FUNCTIONS",          1809
  ) %>% 
  mutate_all(.funs=as.character) %>% 
  mutate(account.code = str_pad(account.code, width=4,side="left",pad="0") )
  



# ref.include -------------------------------------------------------------


ref.include <- tribble(
    ~approp.type, ~account.code,                                     ~approp.name,
       "MILCON",        391,                               "Chemical Demilitarization Construction",
       "MILCON",        500,                                                  "DEFENSE WIDE MILCON",
       "MILCON",        501,                                          "MILCON, RECOVERY ACT MILCON",
       "MILCON",        702,                                                 "Family Housing, Army",
       "MILCON",        703,                                "Family Housing, Navy And Marine Corps",
       "MILCON",        704,                                            "Family Housing, Air Force",
       "MILCON",        706,                                         "Family Housing, Defense-Wide",
       "MILCON",        720,                                    "FAMILY HOUSING CONSTRUCTION, ARMY",
       "MILCON",        721,                      "FAMILY HOUSING CONSTRUCTION, ARMY, RECOVERY ACT",
       "MILCON",        730,              "FAMILIY HOUSING AND CONSTRUCTION, NAVY AND MARINE CORPS",
       "MILCON",        740,                           "FAMILY HOUSING AND CONSTRUCTION, AIR FORCE",
       "MILCON",        743,                "Family Housing Construction - Recovery Act, Air Force",
       "MILCON",        760,                            "FAMILY HOUSING CONSTRUCTION, DEFENSE WIDE",
       "MILCON",        834,               "DEPARTMENT OF DEFENSE FAMILTY HOUSING IMPROVEMENT FUND",
       "MILCON",       1205,                                                          "NAVY MILCON",
       "MILCON",       1206,                           "Military Construction - Recovery Act, Navy",
       "MILCON",       1235,                                                 "NAVAL RESERVE MILCON",
       "MILCON",       2050,                                                          "ARMY MILCON",
       "MILCON",       2051,                           "Military Construction - Recovery Act, Army",
       "MILCON",       2085,                                           "ARMY NATIONAL GUARD MILCON",
       "MILCON",       2086,                                                  "ARMY RESERVE MILCON",
       "MILCON",       2094,            "Military Construction - Recovery Act, Army National Guard",
       "MILCON",       3300,                                                     "AIR FORCE MILCON",
       "MILCON",       3307,                      "Military Construction - Recovery Act, Air Force",
       "MILCON",       3730,                                             "AIR FORCE RESERVE MILCON",
       "MILCON",       3830,                                            "AIR NATIONAL GUARD MILCON",
       "MILCON",       3834,             "Military Construction - Recovery Act, Air National Guard",
       "MILCON",       4090,                                  "HOMEOWNERS ASSISTANCE FUND, DEFENSE",
      "MILPERS",       1105,                                     "Military Personnel, Marine Corps",
      "MILPERS",       1108,                             "Military Personnel, Marine Corps Reserve",
      "MILPERS",       1405,                                              "Reserve Personnel, Navy",
      "MILPERS",       1453,                                             "Military Personnel, Navy",
      "MILPERS",       2010,                                             "Military Personnel, Army",
      "MILPERS",       2060,                                       "National Guard Personnel, Army",
      "MILPERS",       2070,                                              "Reserve Personnel, Army",
      "MILPERS",       3500,                                        "Military Personnel, Air Force",
      "MILPERS",       3700,                                         "Reserve Personnel, Air Force",
      "MILPERS",       3850,                                  "National Guard Personnel, Air Force",
          "O&M",        100,                                                     "Defense-Wide O&M",
          "O&M",        130,                                                   "Defense Health O&M",
          "O&M",        725,                      "FAMILY HOUSING OPERATIONS AND MAINTENANCE, ARMY",
          "O&M",        735,     "FAMILY HOUSING OPERATIONS AND MAINTENANCE, NAVY AND MARINE CORPS",
          "O&M",        745,                 "FAMILY HOUSING OPERATIONS AND MAINTENANCE, AIR FORCE",
          "O&M",        765,              "FAMILY HOUSING OPERATIONS AND MAINTENANCE, DEFENSE WIDE",
          "O&M",       1106,                                                     "Marine Corps O&M",
          "O&M",       1107,                                             "Marine Corps Reserve O&M",
          "O&M",       1116,               "Operation And Maintenance - Recovery Act, Marine Corps",
          "O&M",       1117,       "Operation And Maintenance - Recovery Act, Marine Corps Reserve",
          "O&M",       1804,                                                             "Navy O&M",
          "O&M",       1805,                       "Operation And Maintenance - Recovery Act, Navy",
          "O&M",       1806,                                                     "Navy Reserve O&M",
          "O&M",       1807,               "Operation And Maintenance - Recovery Act, Navy Reserve",
          "O&M",       2020,                                                             "Army O&M",
          "O&M",       2022,                       "Operation And Maintenance - Recovery Act, Army",
          "O&M",       2065,                                              "Army National Guard O&M",
          "O&M",       2066,        "Operation And Maintenance - Recovery Act, Army National Guard",
          "O&M",       2080,                                                     "Army Reserve O&M",
          "O&M",       2081,               "Operation And Maintenance - Recovery Act, Army Reserve",
          "O&M",       3400,                                                        "Air Force O&M",
          "O&M",       3740,                                                "Air Force Reserve O&M",
          "O&M",       3744,          "Operation And Maintenance - Recovery Act, Air Force Reserve",
          "O&M",       3840,                                               "Air National Guard O&M",
          "O&M",       3844,         "Operation And Maintenance - Recovery Act, Air National Guard",
  "Procurement",        300,                                            "Procurement, Defense-Wide",
  "Procurement",        350,                                 "National Guard and Reserve Equipment",
  "Procurement",        513,                 "Ship Modernization, Operations And Sustainment Fund,",
  "Procurement",       1109,                                            "Procurement, Marine Corps",
  "Procurement",       1506,                                           "Aircraft Procurement, Navy",
  "Procurement",       1507,                                            "Weapons Procurement, Navy",
  "Procurement",       1508,                     "Procurement of Ammunition, Navy and Marine Corps",
  "Procurement",       1611,                                    "Shipbuilding and Conversion, Navy",
  "Procurement",       1810,                                              "Other Procurement, Navy",
  "Procurement",       2031,                                           "Aircraft Procurement, Army",
  "Procurement",       2032,                                            "Missile Procurement, Army",
  "Procurement",       2033,             "Procurement of Weapons and Tracked Combat Vehicles, Army",
  "Procurement",       2034,                                      "Procurement of Ammunition, Army",
  "Procurement",       2035,                                              "Other Procurement, Army",
  "Procurement",       3010,                                      "Aircraft Procurement, Air Force",
  "Procurement",       3011,                                 "Procurement of Ammunition, Air Force",
  "Procurement",       3020,                                       "Missile Procurement, Air Force",
  "Procurement",       3021,                                         "Space Procurement, Air Force",
  "Procurement",       3024,                          "Tanker Replacement Transfer Fund, Air Force",
  "Procurement",       3080,                                         "Other Procurement, Air Force",
        "RDT&E",        400,                                                  "RDT&E, Defense-wide",
        "RDT&E",        401,            "Research, Development, Test And Evaluation - Recovery Act",
        "RDT&E",        460,                        "Operational Test and Evaluation, Defense-wide",
        "RDT&E",       1319,                                                          "RDT&E, Navy",
        "RDT&E",       1320,      "Research, Development, Test And Evaluation - Recovery Act, Navy",
        "RDT&E",       2040,                     "Research, Development, Test and Evaluation, Army",
        "RDT&E",       2041,      "Research, Development, Test And Evaluation - Recovery Act, Army",
        "RDT&E",       3600,               "Research, Development, Test, and Evaluation, Air Force",
        "RDT&E",       3605, "Research, Development, Test And Evaluation - Recovery Act, Air Force"
  ) %>% 
  mutate_all(.funs=as.character) %>% 
  mutate(account.code = str_pad(account.code, width=4,side="left",pad="0") )


# ref.exclude -------------------------------------------------------------

ref.exclude <- tibble::tribble(
  ~account.code,                                     ~approp.name,
          41,                                  "Payments to the Military Retirement Fund",
         104,                       "United States Court of Appeals for the Armed Forces",
         105,                             "Drug Interdiction and Counter-Drug Activities",
         107,                                           "Office of the Inspector General",
         111,                                                "Workforce Development Fund",
         112,                            "Office Of The Inspector General - Recovery Act",
         118,                                                         "OCO Transfer Fund",
         120,                                                          "Counter-ISIL OCO",
         134,                                      "Cooperative Threat Reduction Account",
         144,                              "Mine Resistant Ambush Protected Vehicle Fund",
         145,                                        "Counterterrorism Partnerships Fund",
         150,                                     "Defense Health Program - Recovery Act",
         360,                                          "Defense Production Act Purchases",
         380,                                              "Coastal Defense Augmentation",
         390,                                 "Chemical Agents and Munitions Destruction",
         510,                                                                 "BRAC 1990",
         512,                                                                 "BRAC 2005",
         516,                                                                      "BRAC",
         726,             "Family Housing Operation And Maintenance - Recovery Act, Army",
         748,        "Family Housing Operation And Maintenance - Recovery Act, Air Force",
         766,   "General Fund Payment, Surcharge Collections, Sales Of Commissary Stores",
         801,                                             "Foreign Currency Fluctuations",
         803,                      "Foreign Currency Fluctuations, Construction, Defense",
         804,                                         "NATO, SECURITY INVESTMENT PROGRAM",
         810,                                                 "Environmental Restoration",
         811,           "Environmental Restoration, Formerly Used Defense Sites, Defense",
         819,                   "Overseas Humanitarian, Disaster, and Civic AID, Defense",
         833,                                           "Defense Emergency Response Fund",
         836,                       "DOD Military Unaccompanied Housing Improvement Fund",
         838,                           "Support for International Sporting Competitions",
        1000,                  "Medicare-Eligible Retiree Health Fund Contribution, Navy",
        1001,          "Medicare-Eligible Retiree Health Fund Contribution, Marine Corps",
        1002,          "Medicare-Eligible Retiree Health Fund Contribution, Navy Reserve",
        1003,        "Medicare-Eligible Retiree Health Fund Contribution, Marine Reserve",
        1004,                  "Medicare-Eligible Retiree Health Fund Contribution, Army",
        1005,          "Medicare-Eligible Retiree Health Fund Contribution, Army Reserve",
        1006,   "Medicare-Eligible Retiree Health Fund Contribution, Army National Guard",
        1007,             "Medicare-Eligible Retiree Health Fund Contribution, Air Force",
        1008,     "Medicare-Eligible Retiree Health Fund Contribution, Air Force Reserve",
        1009,    "Medicare-Eligible Retiree Health Fund Contribution, Air National Guard",
        1236,                    "Kaho'Olawe Island Environmental Restoration Fund, Navy",
        1612,                                  "National Sea-Based Deterrence Fund, Navy",
        2089,                                 "Iraq Relief and Reconstruction Fund, Army",
        2090,           "Operating Expenses of the Coalition Provisional Authority, Army",
        2091,                                                    "Afghan Security Forces",
        2092,                                                 "Iraq Security Forces Fund",
        2093,                       "Joint Improvised Explosive Device Defeat Fund, Army",
        2095,                                           "Pakistan Counterinsurgency Fund",
        2096,                                     "Afghanistan Infrastructure Fund, Army",
        2097,                                                 "Iraq Train and Equip Fund",
        2099,                                         "Counter-ISIL Train and Equip Fund",
        3404,                       "Operation And Maintenance - Recovery Act, Air Force",
        3999,                   "Consolidated Reporting for DOD Closed Accounts, Defense",
        4091,                        "Homeowners Assistance Fund - Recovery Act, Defense",
        4166,                              "Family Housing Improvement Fund, Direct Loan",
        4167,                          "Family Housing Improvement Fund, Guaranteed Loan",
        4275,                        "Arms Initiative, Guaranteed Loan Financing Account",
        4555,                               "National Defense Stockpile Transaction Fund",
        4557,                                       "National Defense Sealift Fund, Navy",
        4930,                                              "Defense Working Capital Fund",
        4931,                                        "Building Maintenance Fund, Defense",
        4950,                           "Pentagon Reservation Maintenance Revolving Fund",
        4965,                                                   "Emergency Response Fund",
        5098,                                 "Restoration, Rocky Mountain Arsenal, Army",
        5185,                    "Kaho'Olawe Island Environmental Restoration Fund, Navy",
        5187,                                               "Defense Cooperation Account",
        5188,                           "Disposal of Department of Defense Real Property",
        5189,                              "Lease of Department of Defense Real Property",
        5193,                "DOD Overseas Military Facility Investment Recovery Account",
        5195, "Use of Proceeds from the Transfer or Disposition of Commissary Facilities",
        5286,                                             "National Science Center, Army",
        5441,                                               "Burden Sharing Contribution",
        5562,                                           "Ford Island Improvement Account",
        5613,                                            "Mutually Beneficial Activities",
        5616,                                   "Support of Athletic Programs, Air Force",
        5750,                      "Department of Defense Vietnam War Commemoration Fund",
        5751,                 "Contributions to the Cooperative Threat Reduction Program",
        5752,                                   "DOD Korean War Commemoration Fund, Army",
        5753,                        "Renewable Energy Impact Assessments and Mitigation",
        8063, "Bequest of Major General Ainsworth, Library, Walter Reed General Hospital",
        8163,                                                     "DOD General Gift Fund",
        8164,                         "Surcharge Collections, Sales of Commissary Stores",
        8165,                         "Foreign National Employees Separation Pay Account",
        8168,                                    "National Security Education Trust Fund",
        8335,                                       "Voluntary Separation Incentive Fund",
        8337,                        "Host Nation Support for U.S. Relocation Activities",
        8358,                            "Support for U.S. Relocation to Guam Activities",
        8418,                                                      "Air Force Cadet Fund",
        8716,                                  "Department of the Navy General Gift Fund",
        8723,                                               "Ships' Stores Profits, Navy",
        8733,                             "United States Naval Academy General Gift Fund",
        8927,                                  "Department of the Army General Gift Fund",
        8928,                             "Department of the Air Force General Gift Fund"
  ) %>% 
  mutate_all(.funs=as.character) %>% 
  mutate(account.code = str_pad(account.code, width=4,side="left",pad="0") )




# Combine include.exclude -------------------------------------------------
ref.include.exclude.analysis <- ref.include %>% 
  mutate(include.exclude.analysis = "include") %>% 
  select(account.code, approp.name, include.exclude.analysis) %>% 
  bind_rows(ref.exclude %>% 
              mutate(include.exclude.analysis = "exclude") %>% 
              select(account.code, approp.name, include.exclude.analysis) ) %>% 
    mutate(account.code = str_pad(account.code, width=4,side="left",pad="0") ) %>% 
  select(everything(), include.exclude.approp.name=approp.name)
  




